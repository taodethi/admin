(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[192],{8445:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var a=n(3366),r=n(7462),i=n(7294),l=n(6010),s=n(4780),o=n(5861),c=n(1657),d=n(948),u=n(1588),x=n(4867);function h(e){return(0,x.Z)("MuiCardHeader",e)}let p=(0,u.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var f=n(5893);let m=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],v=e=>{let{classes:t}=e;return(0,s.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},h,t)},Z=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,r.Z)({[`& .${p.title}`]:t.title,[`& .${p.subheader}`]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),g=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),j=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),b=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"}),C=i.forwardRef(function(e,t){let n=(0,c.Z)({props:e,name:"MuiCardHeader"}),{action:i,avatar:s,className:d,component:u="div",disableTypography:x=!1,subheader:h,subheaderTypographyProps:p,title:C,titleTypographyProps:y}=n,w=(0,a.Z)(n,m),k=(0,r.Z)({},n,{component:u,disableTypography:x}),N=v(k),S=C;null==S||S.type===o.Z||x||(S=(0,f.jsx)(o.Z,(0,r.Z)({variant:s?"body2":"h5",className:N.title,component:"span",display:"block"},y,{children:S})));let T=h;return null==T||T.type===o.Z||x||(T=(0,f.jsx)(o.Z,(0,r.Z)({variant:s?"body2":"body1",className:N.subheader,color:"text.secondary",component:"span",display:"block"},p,{children:T}))),(0,f.jsxs)(Z,(0,r.Z)({className:(0,l.Z)(N.root,d),as:u,ref:t,ownerState:k},w,{children:[s&&(0,f.jsx)(g,{className:N.avatar,ownerState:k,children:s}),(0,f.jsxs)(b,{className:N.content,ownerState:k,children:[S,T]}),i&&(0,f.jsx)(j,{className:N.action,ownerState:k,children:i})]}))});var y=C},9109:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/p/classes.html",function(){return n(9699)}])},9699:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return B}});var a=n(5893),r=n(7294),i=n(9770),l=n(1163),s=n(7274),o=n(6822),c=n(4267),d=n(8445),u=n(5861),x=n(3321),h=n(9878),p=n(8232),f=n(7109);let m=e=>{let{parent:t="",goBack:n,onSearch:r,onChange:i}=e,l=()=>{i({title:"Th\xeam Nh\xf3m/Khối mới",parent:t,text:"",type:"classes"})},s=()=>{i({title:"Th\xeam Lớp mới",parent:t,text:"",type:"class",year:new Date().getFullYear()})};return(0,a.jsxs)("div",{children:[(0,a.jsx)(d.Z,{title:(0,a.jsx)(u.Z,{variant:"h4",children:"QUẢN L\xdd NH\xd3M/LỚP HỌC"})}),(0,a.jsx)(c.Z,{children:(0,a.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},children:[(0,a.jsx)(o.Z,{children:(0,a.jsx)(x.Z,{variant:"text",startIcon:(0,a.jsx)(h.Z,{icon:"tabler:chevron-left"}),color:"success",onClick:n,children:"Quay lại"})}),(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(p.Z,{size:"small",sx:{mr:1},placeholder:"Nhập t\xean lớp...",InputProps:{startAdornment:(0,a.jsx)(f.Z,{position:"start",children:(0,a.jsx)(h.Z,{icon:"tabler:search"})})},onChange:r}),(0,a.jsx)(x.Z,{variant:"tonal",endIcon:(0,a.jsx)(h.Z,{icon:"tabler:folder-plus"}),sx:{mr:1},onClick:l,children:"TẠO NH\xd3M/KHỐI MỚI"}),(0,a.jsx)(x.Z,{variant:"contained",endIcon:(0,a.jsx)(h.Z,{icon:"tabler:clipboard-plus"}),onClick:s,children:"TẠO LỚP MỚI"})]})]})})]})};var v=r.memo(m),Z=n(4531),g=n(410),j=n(8885),b=n(9334),C=n(8333),y=n(8972),w=n(6455),k=n.n(w),N=n(5591);let S=[{flex:.25,minWidth:290,field:"title",headerName:"KHỐI/LỚP",renderCell:e=>{let{row:t}=e;return(0,a.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center"},children:["class"==t.type?(0,a.jsx)(g.Z,{sx:{mr:3,fontSize:".8rem",width:"2rem",height:"2rem"},src:t.cover,children:(0,a.jsx)(h.Z,{icon:"tabler:list-check"})}):(0,a.jsx)(g.Z,{skin:"light",sx:{mr:3,fontSize:".8rem",width:"2rem",height:"2rem"},src:t.cover,children:(0,a.jsx)(h.Z,{icon:"tabler:users-group"})}),(0,a.jsx)(u.Z,{noWrap:!0,variant:"body1",sx:{color:"text.primary",fontWeight:600},children:t.title})]})}},{flex:.25,minWidth:290,field:"updateAt",headerName:"CẬP NHẬT L\xdaC",renderCell:e=>{let{row:t}=e;return(0,a.jsx)(u.Z,{noWrap:!0,variant:"body2",sx:{color:"text.primary"},children:t.updateAt||t.createAt})}}],T=e=>{let{rows:t,onChange:n,onLoading:i}=e,o=(0,l.useRouter)(),[c,d]=(0,r.useState)({}),[u,x]=(0,r.useState)(null),p=e=>{"classes"==e.type?o.push("?parent="+e.id):o.push("/p/view-classes.html?classes="+e.id)},f=e=>()=>{switch(x(null),e){case"rename":n({...c,title:"Chỉnh sửa th\xf4ng tin",text:c.title});break;case"remove":k().fire({title:"X\xf3a Nh\xf3m/Khối ".concat(c.title,"?"),text:"Sau khi x\xf3a nh\xf3m/khối n\xe0y c\xe1c nh\xf3m/khối/lớp b\xean trong nh\xf3m/khối sẽ được di chuyển th\xe0nh nh\xf3m/khối c\xf9ng cấp với nh\xf3m/khối hiện tại.",icon:"warning",showCancelButton:!0,confirmButtonText:"Đ\xfang. X\xf3a đi.",cancelButtonText:"Hủy"}).then(async e=>{if(e.isConfirmed){i(!0);let e=(await s.default.delete("/classes/"+c.id)).data;i(!1);let{error:t,message:n}=e||{};if(t)return k().fire({position:"top-end",icon:"error",title:t,showConfirmButton:!1,timer:1500});n&&((0,N.JG)(c.parent?"/classes/".concat(c.parent):"/classes",c,{revalidate:!1,populateCache:(e,t)=>{let n=t.filter(t=>t.id!==e.id);return[...n]}}),k().fire({position:"top-end",icon:"success",title:n,showConfirmButton:!1,timer:1500}))}})}},m={classes:[{text:"Chia sẻ",icon:"tabler:user-plus",onClick:f("share"),divider:!0},{text:"Đổi t\xean",icon:"tabler:pencil",onClick:f("rename")},{text:"X\xf3a",icon:"tabler:trash-filled",onClick:f("remove")}],class:[{text:"Đổi t\xean",icon:"tabler:pencil",onClick:f("rename")},{text:"X\xf3a",icon:"tabler:trash-filled",onClick:f("remove")}]},v=e=>{e.preventDefault();var[n]=t.filter(t=>t.id==e.currentTarget.getAttribute("data-id"));d(n),x(null===u?{mouseX:e.clientX-2,mouseY:e.clientY-4}:null)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z._,{autoHeight:!0,rows:t,columns:S,initialState:{pagination:{paginationModel:{pageSize:15}}},pageSizeOptions:[15,25,50],slotProps:{row:{onContextMenu:v,style:{cursor:"context-menu"}}},disableRowSelectionOnClick:!0,onRowClick:e=>p(e.row)}),(0,a.jsx)(C.Z,{open:null!==u,onClose:e=>x(null),anchorReference:"anchorPosition",anchorPosition:null!==u?{top:u.mouseY,left:u.mouseX}:void 0,slotProps:{root:{onContextMenu:e=>{e.preventDefault(),x(null)}}},children:(m[c.type]||[]).map((e,t)=>(0,a.jsxs)(y.Z,{onClick:e.onClick,divider:e.divider,children:[(0,a.jsx)(j.Z,{children:(0,a.jsx)(h.Z,{icon:e.icon,fontSize:16})}),(0,a.jsx)(b.Z,{primary:e.text})]},t))})]})};var P=n(948),R=n(9581),I=n(1425),H=n(3946),M=n(8262),_=n(6628);let z=(0,P.ZP)(H.Z)(e=>{let{theme:t}=e;return{top:0,right:0,color:"grey.500",position:"absolute",boxShadow:t.shadows[2],transform:"translate(10px, -10px)",borderRadius:t.shape.borderRadius,backgroundColor:"".concat(t.palette.background.paper," !important"),transition:"transform 0.25s ease-in-out, box-shadow 0.25s ease-in-out","&:hover":{transform:"translate(7px, -5px)"}}}),L=()=>{let e=new Date().getFullYear();return Array(10).fill(0).map((t,n)=>n+e-3)},A=(0,r.forwardRef)(function(e,t){return(0,a.jsx)(_.Z,{ref:t,...e})}),W=e=>{let{popup:t,onChange:n,onLoading:i}=e,[l,c]=(0,r.useState)(t||{}),d=()=>{n(null)},f=async()=>{let{title:e,...n}=l;if(!n.text.trim()||n.text.trim()===t.text.trim())return;i(!0);let a=(await s.default.post("/classes",n)).data;if(i(!1),a.error)return k().fire({icon:"error",title:"Oops...",text:a.error});(0,N.JG)(a.parent?"/classes/".concat(a.parent):"/classes",a,{revalidate:!1,populateCache:(e,t)=>{let n=[...t],a=t.findIndex(t=>t.id===e.id);return a>=0?n[a]=e:n.push(e),[...n]}}),d()};return(0,r.useEffect)(()=>{c(t||{})},[t]),(0,a.jsxs)(M.Z,{fullWidth:!0,open:!!t,maxWidth:"sm",scroll:"body",TransitionComponent:A,sx:{"& .MuiDialog-paper":{overflow:"visible"}},children:[(0,a.jsxs)(R.Z,{sx:{pb:e=>"".concat(e.spacing(2)," !important"),px:e=>["".concat(e.spacing(5)," !important"),"".concat(e.spacing(5)," !important")]},children:[(0,a.jsx)(z,{onClick:d,children:(0,a.jsx)(h.Z,{icon:"tabler:x",fontSize:"1.25rem"})}),(0,a.jsxs)(o.Z,{sx:{mb:2,textAlign:"left"},children:[(0,a.jsx)(u.Z,{variant:"h4",sx:{mb:3},children:l.title}),(0,a.jsx)(u.Z,{variant:"body",sx:{mb:3},children:"Bạn c\xf3 thể dễ d\xe0ng quản l\xfd c\xe1c lớp học của m\xecnh theo từng khối hoặc nh\xf3m một c\xe1ch dễ d\xe0ng hơn."})]}),(0,a.jsxs)(R.Z,{sx:{paddingX:"0!important"},children:["classes"===l.type?(0,a.jsx)(p.Z,{value:l.text,onChange:e=>c({...l,text:e}),fullWidth:!0,placeholder:"Vui l\xf2ng nhập t\xean Nh\xf3m/Kh\xf4i",label:"T\xean Nh\xf3m/Khối"}):null,"class"===l.type?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{value:l.text,onChange:e=>c({...l,text:e}),fullWidth:!0,placeholder:"Vui l\xf2ng nhập t\xean lớp",label:"T\xean lớp"}),(0,a.jsx)(p.Z,{select:!0,fullWidth:!0,label:"Năm học",sx:{mt:5},value:l.year||new Date().getFullYear(),onChange:e=>c({...l,year:e}),children:L().map(e=>(0,a.jsxs)(y.Z,{value:e,children:[e," - ",e+1]},e))})]}):null]})]}),(0,a.jsxs)(I.Z,{sx:{justifyContent:"center",px:e=>["".concat(e.spacing(5)," !important"),"".concat(e.spacing(5)," !important")],pb:e=>["".concat(e.spacing(5)," !important"),"".concat(e.spacing(5)," !important")]},children:[(0,a.jsx)(x.Z,{variant:"tonal",color:"secondary",onClick:d,children:"Hủy"}),(0,a.jsx)(x.Z,{variant:"contained",sx:{mr:1},onClick:f,children:"Lưu"})]})]})};var X=n(4273);let E=async e=>{try{return(await s.default.get(e)).data}catch(e){throw e}},O=()=>{var e;let t=(0,l.useRouter)(),[n,s]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[u,x]=(0,r.useState)(null),{parent:h}=t.query,{data:p,isLoading:f}=(0,i.Z)(t.isReady?h?"/classes/".concat(h):"/classes":null,E);return(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(v,{parent:h||"",goBack:()=>t.back(),onSearch:e=>s(e),onChange:e=>x(e)}),(0,a.jsx)(T,{rows:null===(e=p||[])||void 0===e?void 0:e.filter(e=>null==e?void 0:e.title.includes(n)),onLoading:e=>d(e),onChange:e=>x(e)}),(0,a.jsx)(X.Z,{open:f||c}),(0,a.jsx)(W,{popup:u,onChange:e=>x(e),onLoading:e=>d(e)})]})};var B=()=>(0,a.jsx)(O,{})},8232:function(e,t,n){"use strict";var a=n(5893),r=n(7294),i=n(1903);let l=e=>(e||"").toLowerCase().split(" ").map(function(e){return e.replace(e.charAt(0),e.charAt(0).toUpperCase())}).join(" "),s=e=>{let t=Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!["onSearch","capitalize","uppercase","timeout"].includes(t)})),[n,s]=(0,r.useState)(e.value||""),o=(0,r.useRef)(null),c=t=>{var{value:n}=t.target;n=e.uppercase?(n||"").toLocaleUpperCase():n||"",s(n=e.capitalize?l(n||""):n||""),clearTimeout(o.current),o.current=setTimeout(()=>{e.onChange&&e.onChange(n)},e.timeout||500)};return(0,r.useEffect)(()=>()=>{clearTimeout(o.current)},[]),(0,r.useEffect)(()=>{e.value!=n&&s(e.value||"")},[e.value]),(0,a.jsx)(i.Z,{...t,onChange:c,value:n})};t.Z=s},4273:function(e,t,n){"use strict";var a=n(5893),r=n(5861),i=n(4808),l=n(8456);let s=e=>{let{open:t}=e;return(0,a.jsxs)(i.Z,{sx:{color:"#fff",zIndex:1301,display:"flex",flexDirection:"column"},open:t,children:[(0,a.jsx)(l.Z,{color:"inherit"}),(0,a.jsx)(r.Z,{variant:"h5",sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1,mt:3},children:"VUI L\xd2NG ĐỢI"})]})};t.Z=s}},function(e){e.O(0,[125,336,774,888,179],function(){return e(e.s=9109)}),_N_E=e.O()}]);