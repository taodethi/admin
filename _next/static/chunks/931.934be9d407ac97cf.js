"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4931:function(i,t,e){e.r(t),e.d(t,{default:function(){return N}});var n=e(5893),a=e(1167),r=e.n(a),g=e(7294),m=e(1008),h=e(6822),s=e(8262),l=e(9581),o=e(5861),p=e(3946),c=e(9878),d=e(948),u=e(5382),f=e(44),w=e(298),x=e(4769),L=e(5670),T=e(7720);let k="https://www.wiris.net/demo/editor/resources/icons/icons.png?v=7.20.1.149f34",b=[{span:{width:30,height:20},img:{marginLeft:-1268,marginTop:-544},name:"General",childrens:[{width:"50%",items:[{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-2},click:{tex:"\\frac{#1}{#0}"}},{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-101},click:{tex:"\\sqrt{#0}"}},{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-35},click:{tex:"{#0}\\setminus{#0}"}},{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-167},click:{tex:"\\sqrt[#0]{#0}"}}]},{width:"100%",items:[{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-233},click:{tex:"{#0}^{#0}"}},{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-299},click:{tex:"{#0}_{#0}"}}]},{width:"50%",items:[{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-365},click:{tex:"(#0)"}},{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-431},click:{tex:"{[#0]}"}},{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-398},click:{tex:"{|#0|}"}},{span:{width:33,height:33},img:{marginLeft:-2,marginTop:-464},click:{tex:"\\begin{Bmatrix}{#0}\\end{Bmatrix}"}}]},{width:"50%",items:[{span:{width:22,height:22},img:{marginLeft:-2,marginTop:-497},click:{tex:"+"}},{span:{width:22,height:22},img:{marginLeft:-2,marginTop:-563},click:{tex:"/"}},{span:{width:22,height:22},img:{marginLeft:-2,marginTop:-519},click:{tex:"\\times"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-2},click:{tex:"\\pm"}},{span:{width:22,height:22},img:{marginLeft:-2,marginTop:-541},click:{tex:"-"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-24},click:{tex:"\\div"}}]},{width:"50%",items:[{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-46},click:{tex:"\\geqslant"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-90},click:{tex:"\\leqslant"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-134},click:{tex:"\\in"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-178},click:{tex:"\\subset"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-222},click:{tex:"\\cup"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-244},click:{tex:"\\cap"}}]},{width:"100%",items:[{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-266},click:{tex:"\\varnothing"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-288},click:{tex:"\\infin"}},{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-310},click:{tex:"\\pi"}}]}]},{span:{width:30,height:20},img:{marginLeft:-1302,marginTop:-170},name:"Symbols",childrens:[{width:"100%",items:[{span:{width:22,height:22},img:{marginLeft:-35,marginTop:-574},click:{tex:" \\cancel{{#0}}"}}]},{width:"33%",items:[{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-112}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-178}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-244}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-134}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-200}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-266}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-156}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-222}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-288}}]},{width:"33%",items:[{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-376}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-442}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-530}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-398}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-486}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-552}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-420}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-508}},{span:{width:22,height:22},img:{marginLeft:-57,marginTop:-574}}]},{width:"50%",items:[{span:{width:22,height:22},img:{marginLeft:-79,marginTop:-178}},{span:{width:22,height:22},img:{marginLeft:-79,marginTop:-288}},{span:{width:22,height:22},img:{marginLeft:-79,marginTop:-200}},{span:{width:22,height:22},img:{marginLeft:-79,marginTop:-310}},{span:{width:22,height:22},img:{marginLeft:-79,marginTop:-244}},{span:{width:22,height:22},img:{marginLeft:-79,marginTop:-354}}]},{width:"50%",items:[{span:{width:22,height:22},img:{marginLeft:-101,marginTop:-200}},{span:{width:22,height:22},img:{marginLeft:-101,marginTop:-332}},{span:{width:22,height:22},img:{marginLeft:-101,marginTop:-244}},{span:{width:22,height:22},img:{marginLeft:-101,marginTop:-376}},{span:{width:22,height:22},img:{marginLeft:-101,marginTop:-288}},{span:{width:22,height:22},img:{marginLeft:-101,marginTop:-420}}]},{width:"50%",items:[{span:{width:22,height:22},img:{marginLeft:-123,marginTop:-266}},{span:{width:22,height:22},img:{marginLeft:-123,marginTop:-310}},{span:{width:22,height:22},img:{marginLeft:-123,marginTop:-354}},{span:{width:22,height:22},img:{marginLeft:-123,marginTop:-376}},{span:{width:22,height:22},img:{marginLeft:-123,marginTop:-398}},{span:{width:22,height:22},img:{marginLeft:-123,marginTop:-442}}]},{width:"50%",items:[{span:{width:22,height:22},img:{marginLeft:-123,marginTop:-574}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-2}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-24}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-46}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-68}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-112}}]},{width:"100%",items:[{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-310}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-354}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-376}}]},{width:"100%",items:[{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-442}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-464}},{span:{width:22,height:22},img:{marginLeft:-145,marginTop:-486}}]},{width:"100%",items:[{span:{width:22,height:22},img:{marginLeft:-167,marginTop:-2}},{span:{width:22,height:22},img:{marginLeft:-167,marginTop:-24}},{span:{width:22,height:22},img:{marginLeft:-167,marginTop:-46}}]}]},{span:{width:30,height:20},img:{marginLeft:-1302,marginTop:-310},name:"Arrows"},{span:{width:30,height:20},img:{marginLeft:-1302,marginTop:-572},name:"Greek"},{span:{width:30,height:20},img:{marginLeft:-1268,marginTop:-2},name:"Matrices"},{span:{width:30,height:20},img:{marginLeft:-1268,marginTop:-288},name:"Scripts"},{span:{width:30,height:20},img:{marginLeft:-1268,marginTop:-520},name:"Decorations"},{span:{width:30,height:20},img:{marginLeft:-1302,marginTop:-74},name:"BigOperators"},{span:{width:30,height:20},img:{marginLeft:-1302,marginTop:-238},name:"Calculus"}],v=i=>{let{onClick:t}=i,[e,a]=(0,g.useState)("General"),r=(i,t)=>{a(t)};return(0,n.jsxs)(L.ZP,{value:e,children:[(0,n.jsx)(w.Z,{scrollButtons:!0,variant:"scrollable",onChange:r,children:b.map(i=>(0,n.jsx)(f.Z,{value:i.name,sx:{paddingX:2,minWidth:60},label:(0,n.jsx)("span",{style:i.span,className:"formula-tabs",children:(0,n.jsx)("img",{src:k,style:i.img})})},i.name))}),b.map(i=>(0,n.jsx)(x.Z,{value:i.name,children:(0,n.jsx)(h.Z,{sx:{mb:3.5,gap:2,display:"flex"},children:(i.childrens||[]).map((i,e)=>(0,n.jsxs)(g.Fragment,{children:[(0,n.jsx)(h.Z,{sx:{display:"flex",flexWrap:"wrap"},children:i.items.map((e,a)=>(0,n.jsx)(h.Z,{sx:{flexGrow:1,width:i.width,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,n.jsx)(p.Z,{sx:{p:0},onClick:()=>t(e.click),children:(0,n.jsx)("span",{style:e.span,className:"formula-tabs",children:(0,n.jsx)("img",{src:k,style:e.img})})})},a))}),(0,n.jsx)(T.Z,{flexItem:!0,sx:{m:0},orientation:"vertical"})]},e))})},i.name))]})};var y=e(1425),j=e(3321),C=i=>{let{formula:t,onClose:e,onChange:a}=i,r=(0,g.useRef)(null),m=(0,g.useMemo)(()=>new u.Ak({}),[]),h=(0,g.useRef)("");(0,g.useEffect)(()=>{let i=r.current;i.innerHTML="",i.appendChild(m),m.style.width="100%",m.addEventListener("input",i=>{let{target:t}=i,e=t.value||"";h.current!==e&&(h.current=e)})},[]),(0,g.useEffect)(()=>{let{tex:i}=t||{};h.current!==i&&(m.setValue(i,{focus:!0,feedback:!1}),h.current=i)},[t]);let s=i=>{if(!i)return;let{tex:t}=i;i&&t&&m.executeCommand(["insert",t])},o=async()=>{t.onChange&&t.onChange(h.current,t.quillRef)};return(0,n.jsxs)(g.Fragment,{children:[(0,n.jsxs)(l.Z,{children:[(0,n.jsx)(v,{onClick:s}),(0,n.jsx)("div",{ref:r,style:{width:"100%"}})]}),(0,n.jsxs)(y.Z,{children:[(0,n.jsx)(j.Z,{variant:"tonal",color:"secondary",onClick:e,children:"Huỷ"}),(0,n.jsx)(j.Z,{variant:"contained",onClick:o,children:"Lưu"})]})]})};let E=(0,d.ZP)(p.Z)(i=>{let{theme:t}=i;return{top:0,right:0,color:"grey.500",position:"absolute",boxShadow:t.shadows[2],transform:"translate(10px, -10px)",borderRadius:t.shape.borderRadius,backgroundColor:"".concat(t.palette.background.paper," !important"),transition:"transform 0.25s ease-in-out, box-shadow 0.25s ease-in-out","&:hover":{transform:"translate(7px, -5px)"}}}),Z=i=>{let{formula:t,onClose:e}=i;return t&&t.status?(0,n.jsxs)(s.Z,{fullWidth:!0,maxWidth:"md",scroll:"body",open:!!t,sx:{"& .MuiDialog-paper":{overflow:"visible"}},children:[(0,n.jsxs)(l.Z,{sx:{p:i=>["".concat(i.spacing(4)," !important"),"".concat(i.spacing(4)," !important")]},children:[(0,n.jsx)(o.Z,{variant:"h4",children:"Chỉnh sửa c\xf4ng thức"}),(0,n.jsx)(E,{onClick:e,children:(0,n.jsx)(c.Z,{icon:"tabler:x",fontSize:"1.25rem"})})]}),(0,n.jsx)(C,{formula:t,onClose:e})]}):null};e(8594),e(6165);var A=e(8460);window.katex=m.Z,a.Quill.register(A.ImageBlot,!0),a.Quill.register(A.SpanEnglish,!0);let S=i=>{let{content:t,onChange:e,theme:a="snow",inline:m=!1,placeholder:s="Vui l\xf2ng nhập nội dung"}=i,[l,o]=(0,g.useState)(""),p=(0,g.useRef)(null),c=(0,g.useRef)(null),[d,u]=(0,g.useState)(!1),[f,w]=(0,g.useState)(null),x=(0,g.useCallback)(i=>{w({tex:i})},[w]),L=()=>{let i=p.current.getEditor();i.root.querySelectorAll(".ql-formula").forEach(i=>{i.removeEventListener("click",()=>x(i.getAttribute("data-value"))),i.addEventListener("click",()=>x(i.getAttribute("data-value")))})},T=(0,g.useCallback)(async(i,t)=>{let e=t.current.getEditor(),n=e.getSelection(!0);f.tex?(e.deleteText(n.index-1,1),e.insertEmbed(n.index-1,"formula",i),e.setSelection(n.index+n.length)):(e.insertEmbed(n.index,"formula",i),e.setSelection(n.index+n.length+1)),w(null)},[f,w]);(0,g.useLayoutEffect)(()=>{let i=async()=>{f&&!f.status&&w({...f,status:!0,quillRef:p,onChange:T})};i()},[f]);let k=(0,g.useMemo)(()=>({toolbar:{container:[["bold","italic","underline"],["image","formula"]],handlers:{formula:()=>w({tex:""})}}}),[]);(0,g.useEffect)(()=>{if(d){let i=p.current.getEditor();i.focus()}},[d]),(0,g.useEffect)(()=>{let i=async()=>{try{let i=await (0,A.renderContent)(t||"");o(i)}catch(i){console.error("Error fetching content:",i),o("Lỗi khi hiển thị nội dung.")}};i()},[t]);let b=async i=>{o(i),clearTimeout(c.current),c.current=setTimeout(()=>{e&&e(i)},500)};return(0,n.jsx)("div",{className:"text-editor",children:d||m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r(),{theme:a,ref:p,placeholder:s,value:l,modules:k,onChange:b,onFocus:L}),(0,n.jsx)(Z,{formula:f,onClose:()=>w(null),content:l})]}):(0,n.jsx)(h.Z,{onClick:()=>u(!0),sx:{minHeight:"2rem"},className:"ql-editor",dangerouslySetInnerHTML:{__html:l||s}})})};var N=g.memo(S)},8460:function(i,t,e){Object.defineProperty(t,"__esModule",{value:!0});let n=e(1167),a=n.Quill.import("blots/embed");class r extends a{static create(i){var t=null;t="string"==typeof i?{src:i}:i;let e=super.create();e.setAttribute("src",t.src);let n=t["data-value"];if(e.setAttribute("data-value",n||""),e.setAttribute("style",t.style||""),n){let{link:i,data:t}=JSON.parse(n),a=document.createElement("canvas"),r=a.getContext("2d"),g=new Image;g.src=i,g.crossOrigin="anonymous",g.onload=function(){a.width=t.width,a.height=t.height,r.drawImage(g,t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.setAttribute("src",a.toDataURL("image/png"))}}return e}static value(i){return{src:i.getAttribute("src"),"data-value":i.getAttribute("data-value"),style:i.getAttribute("style")}}}r.blotName="image",r.className="quill-image",r.tagName="img";class g extends a{static create(i){let t=super.create();return t.setAttribute("style",i.style||""),t.innerHTML=i.innerHTML,t}static value(i){return{style:i.getAttribute("style"),innerHTML:i.innerHTML}}}g.blotName="span-english",g.className="qv_string_eng_ans",g.tagName="span";let m=i=>new Promise(t=>{let{link:e,data:n}=JSON.parse(i),a=document.createElement("canvas"),r=a.getContext("2d"),g=new Image;g.src=e,g.crossOrigin="anonymous",g.onload=async function(){a.width=n.width,a.height=n.height,r.drawImage(g,n.x,n.y,n.width,n.height,0,0,n.width,n.height),t(a.toDataURL("image/png"))}}),h=i=>{if(!i)return"";var t=i.match(/\$([^$]+)\$/g);if(t)for(var e=0;e<t.length;e++){var n=t[e].replace(/\$/g,""),a=document.createElement("span");a.setAttribute("class","ql-formula"),a.setAttribute("data-value",n),i=i.replace(t[e],a.outerHTML)}return i.replace(/′/g,"'").replace(/\u2009/g," ").replace(/\u2004/g," ").replace(/\u00AF/g,"-")},s=async i=>{let t=document.createElement("div");t.innerHTML=h(i);let e=t.getElementsByClassName("ql-formula");for(let i=e.length-1;i>=0;i--){let t=e[i],n=t.getAttribute("data-value");n&&(t.innerHTML=katex.renderToString(n,{throwOnError:!1}))}let n=t.getElementsByTagName("img");for(let i=0;i<n.length;i++){let t=n[i],e=t.getAttribute("data-value");e&&(t.src=await m(e))}return t.innerHTML};i.exports={ImageBlot:r,SpanEnglish:g,renderContent:s}}}]);